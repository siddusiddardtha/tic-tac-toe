<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Tic Tac Toe</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; background-color: #f0f0f0; }
        h1 { color: #333; margin-top: 20px; }
        .board { display: grid; grid-template-columns: repeat(3, 100px); margin: 20px auto; }
        .cell {
            width: 100px; height: 100px; 
            border: 2px solid #333;
            font-size: 50px; 
            display: flex; 
            justify-content: center; 
            align-items: center;
            cursor: pointer;
            background-color: #fff;
            transition: background-color 0.3s;
        }
        .cell:hover { background-color: #e6e6e6; }
        button { margin: 10px; padding: 10px 20px; font-size: 16px; cursor: pointer; }
        #scoreboard { margin-top: 20px; font-size: 18px; }
        #message { font-size: 20px; font-weight: bold; margin: 15px 0; }
    </style>
</head>
<body>

<h1>Tic Tac Toe</h1>

<div id="modeSelection">
    <button onclick="startGame('friend')">Play with Friend</button>
    <button onclick="startGame('computer')">Play with Computer</button>
</div>

<div class="board" id="board" style="display:none;"></div>
<p id="message"></p>

<div id="scoreboard" style="display:none;">
    <p>Player X Wins: <span id="xScore">0</span></p>
    <p>Player O Wins: <span id="oScore">0</span></p>
</div>

<button id="restartBtn" style="display:none;" onclick="restartGame()">Restart</button>

<script>
    const board = document.getElementById("board");
    const message = document.getElementById("message");
    const restartBtn = document.getElementById("restartBtn");
    const scoreboard = document.getElementById("scoreboard");
    let xScore = 0;
    let oScore = 0;
    let currentPlayer = "X";
    let cells = [];
    let gameMode = "";

    function startGame(mode) {
        gameMode = mode;
        document.getElementById("modeSelection").style.display = "none";
        board.style.display = "grid";
        scoreboard.style.display = "block";
        restartBtn.style.display = "inline-block";
        initBoard();
    }

    function initBoard() {
        board.innerHTML = "";
        cells = [];
        currentPlayer = "X";
        message.innerText = "";
        board.style.pointerEvents = "auto";

        for (let i = 0; i < 9; i++) {
            let cell = document.createElement("div");
            cell.className = "cell";
            cell.addEventListener("click", () => cellClick(cell));
            board.appendChild(cell);
            cells.push(cell);
        }
    }

    function cellClick(cell) {
        if (cell.innerText === "" && board.style.pointerEvents !== "none") {
            cell.innerText = currentPlayer;
            if (checkWinner()) {
                handleWin(currentPlayer);
                return;
            }
            if (isDraw()) {
                message.innerText = "It's a draw!";
                board.style.pointerEvents = "none";
                return;
            }
            currentPlayer = currentPlayer === "X" ? "O" : "X";

            if (gameMode === "computer" && currentPlayer === "O") {
                setTimeout(computerMove, 500);
            }
        }
    }

    function computerMove() {
        // Simple AI: first try to win, then block, then random move
        let move = findBestMove("O") || findBestMove("X") || randomMove();
        if (move !== null) {
            cells[move].innerText = "O";
            if (checkWinner()) {
                handleWin("O");
                return;
            }
            if (isDraw()) {
                message.innerText = "It's a draw!";
                board.style.pointerEvents = "none";
                return;
            }
            currentPlayer = "X";
        }
    }

    function findBestMove(player) {
        for (let i = 0; i < cells.length; i++) {
            if (cells[i].innerText === "") {
                cells[i].innerText = player;
                if (checkWinner()) {
                    cells[i].innerText = "";
                    return i;
                }
                cells[i].innerText = "";
            }
        }
        return null;
    }

    function randomMove() {
        let emptyCells = cells.map((cell, idx) => cell.innerText === "" ? idx : null).filter(idx => idx !== null);
        return emptyCells.length > 0 ? emptyCells[Math.floor(Math.random() * emptyCells.length)] : null;
    }

    function checkWinner() {
        const wins = [
            [0,1,2], [3,4,5], [6,7,8],
            [0,3,6], [1,4,7], [2,5,8],
            [0,4,8], [2,4,6]
        ];

        return wins.some(win => {
            const [a, b, c] = win;
            return cells[a].innerText !== "" &&
                   cells[a].innerText === cells[b].innerText &&
                   cells[a].innerText === cells[c].innerText;
        });
    }

    function isDraw() {
        return [...cells].every(cell => cell.innerText !== "");
    }

    function handleWin(player) {
        message.innerText = `Player ${player} wins!`;
        board.style.pointerEvents = "none";
        if (player === "X") {
            xScore++;
            document.getElementById("xScore").innerText = xScore;
        } else {
            oScore++;
            document.getElementById("oScore").innerText = oScore;
        }
    }

    function restartGame() {
        initBoard();
    }
</script>

</body>
</html>
